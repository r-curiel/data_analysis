---
title: "Melhores Filmes e Séries"
author: "Rafael Vinicius Curiel"
date: "13/12/2021"
output: html_document
---

## Pacotes e comandos

```{r}
library(tidyverse)
library(readxl)
```



## Filmes

Dataset movies
```{r}
movies <- utils::read.csv("D:/datasets/movies.csv")
```


## Séries

Dataset tvshow
```{r}
tvshow <- utils::read.csv("D:/datasets/tvshow.csv")
```



### Exploração

Visão estrutural filmes:
```{r}
dplyr::glimpse(movies)
```


Visão estrutural séries:
```{r}
dplyr::glimpse(tvshow)
```


### Manipulação

União das bases de dados:
```{r}
dataset <- movies %>% dplyr::select(everything(), -(Directors:Runtime)) %>% 
                      dplyr::bind_rows(tvshow) %>% 
                      dplyr::select(!X)
```


Alteração dos tipos dos dados das variáveis IMDb e Rotten Tomatoes:
```{r}
aj_imdb <- base::as.numeric(str_sub(dataset$IMDb, 1, 3))
aj_rotten <- stringr::str_sub(dataset$Rotten.Tomatoes, 1, 3)
aj_rotten <- base::gsub("/", "", aj_rotten)
aj_rotten <- as.numeric(aj_rotten)
```


Aplicação das alterações:
```{r}
dataset <- dataset %>% dplyr::mutate(IMDB = aj_imdb,
                                 ROTTEN = aj_rotten)
```




### Resumo estatístico

Resumo descritivo aplicado às médias das notas do percentil 95:
```{r}
dataset %>% mutate(Type = replace(Type, Type==1, "serie"), 
                    Type = replace(Type, Type==0, "filme"))  %>%
  dplyr::group_by(Type) %>%
  dplyr::summarise(media_IMDB=mean(IMDB, na.rm=T),
            media_ROTTEN=mean(ROTTEN, na.rm=T),
            p95_IMDB=quantile(IMDB, probs=0.95, type=5, na.rm=T),
            p95_ROTTEN=quantile(ROTTEN, probs=0.95, type=5, na.rm=T)) %>%
  dplyr::ungroup() %>% base::droplevels(.)
```



### Resultados

Seleção dos melhores filmes
```{r}
best_movies <- dataset %>% dplyr::filter(Type==0) %>% 
  dplyr::mutate(melhores_IMDb = base::cut(IMDB, 
                            c(-Inf, stats::quantile(IMDB, probs=0.95, type=5, na.rm=T), Inf), c(0,1)),
                melhores_ROTTEN = cut(ROTTEN,
                            c(-Inf, quantile(ROTTEN, probs=0.95, type=5, na.rm=T), Inf), c(0,1))) %>% 
  dplyr::filter(melhores_IMDb==1&melhores_ROTTEN==1)
```


Seleção das melhores séries
```{r}
best_tvshow <- dataset %>% filter(Type==1) %>% 
  mutate(melhores_IMDb = cut(IMDB, c(-Inf, quantile(IMDB, probs=0.95, type=5, na.rm=T), Inf), c(0,1)),
         melhores_ROTTEN = cut(ROTTEN, c(-Inf, quantile(ROTTEN, probs=0.95, type=5, na.rm=T), Inf), c(0,1))) %>%
  filter(melhores_IMDb==1&melhores_ROTTEN==1)
```



### Visualização

10 Melhores Filmes
```{r}
utils::head(best_movies, 10)
```


10 Melhores Séries
```{r}
utils::head(best_tvshow, 10)
```

