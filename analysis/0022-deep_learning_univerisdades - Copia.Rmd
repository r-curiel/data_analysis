---
title: "Deep Learning Classificação - Universidades Públicas x Particulares"
author: "Rafael Vinicius Curiel"
date: "26/03/2022"
output: html_document
---

## Pacotes e comandos

Carregamento dos pacotes  
```{r message=FALSE, warning=FALSE}
pacotes <- c("MASS","neuralnet","ISLR","mlbench","neuralnet","rpart")
sapply(pacotes, require, character = T) 
```


## Carregamento do objeto

Carregamento da base de dados - Valoers de casas no subúrbio de Boston
```{r message=FALSE, warning=FALSE}
data <- College
head(data)
```



### Manipulação

Identificação de Universidades Privadas:
```{r}
private <- ifelse(data$Private == 'Yes', 1, 0)
```


Padronização dos Dados:
```{r}
data <- data[,2:18]  # Seleção das variáveis exceto a target

max_data <- apply(data, 2, max)  # Maior valor de cada coluna  
min_data <- apply(data, 2, min)  # Menor valor de cada coluna

scaled <- data.frame(scale(data,center = min_data, scale = max_data - min_data))  # Min Max Scale
```


Inclusão da Variável Explicativa (target):
```{r}
scaled$Private <- private
```


Divisão de Treino e Teste (Amostras Aleatórios):
```{r}
index = sample(1:nrow(data),round(0.80*nrow(data)))  # Separação de 80% da Base de Dados

train_data <- as.data.frame(scaled[index,])  # Delimitação do treino
test_data <- as.data.frame(scaled[-index,])  # Delimitação do que não é treino
```



### Neuralnet

Divisão de Treino e Teste (Amostras Aleatórios):
```{r}
set.seed(1993)

n = names(train_data)  # Nomes das features
f <- as.formula(paste("Private ~", paste(n[!n %in% "Private"], collapse = " + ")))  # String das features

# Linear.output False para variável classificatória
nn <- neuralnet(f, data=train_data, hidden=c(5,4), linear.output=F)  

plot(nn, rep="best")
```


Previsões NN
```{r}
pr.nn <- compute(nn,test_data[,1:17])  # Previsões estimadas

# Arredondamento com função round
pr.nn$net.result <- sapply(pr.nn$net.result, round, digits=0)
pr.nn$net.result
```


Resultados NN
```{r}
res <- table(test_data$Private,pr.nn$net.result)
res
```


Acurácia NN
```{r}
Acc <- (res[1,1]+res[2,2]) / sum(res)
Acc
```


### Comparação CART

Previsões CART - Classification and Regression Trees
```{r}
fit_tree <- rpart(f, method="class", data=train_data)
```


Resultados Tree
```{r}
tree_predict <- predict(fit_tree, test_data, type = "class")
res_t <- table(test_data$Private, tree_predict)
res_t
```


Acurácia Tree
```{r}
Acc_t <- (res_t[1,1]+res_t[2,2]) / sum(res_t)
Acc_t
```
